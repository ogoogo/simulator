%% ---------------------------------------------------------------
%  Name:        ti2UtcConverter_multi.m
%  Purpose:
%  This program can calculate ephemeris time from TI
%  The case with regard to revNum needs to be updated
%
%  Author:      Kawabata
%
%  Created:     Jan. 06 2015
%  Modyfied:    Jan. 06 2015
%  Copyright:   (c) Yosuke Kawabata 2014
%  Licence:     <Yosuke Kawabata>
%
% -------------------------------------------------------------------------
% INPUT: 
% ti: TI[dec] 
% ti = 3871330; % test value for ti '2014/12/07 18:01:09.350'

function [ti2Utc,ti2UtcStr] = ti2UtcConverter_multiv0(ti,revNum)
    lightSpeed    = 299792.458;
    
    switch revNum            
        case {...
              '220803-1279',...
            }
            a        = [1./0.099813939065	0];
            epochUtc = '2022/08/03 2:14:45.077';
            
        case {...
              '221116-0500',...
            }
            a        = [1./0.099991544184	0];
            epochUtc = '2022/11/16 10:27:42.585';
        case {...
              '221116-0600',...
            }
            a        = [1./0.099996317705	0];
            epochUtc = '2022/11/16 10:27:42.560';
        case {...
              '221117-0500',...
            }
            a        = [1./0.099997408960	0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {...
              '221117-0600',...
              '221117-0100',...
            }
            a        = [1./0.099997482974	0];
            epochUtc = '2022/11/16 10:28:47';

        case {...
              '221118-0100',...
            }
            a        = [1./0.099997712679	0];
            epochUtc = '2022/11/16 10:27:42.553';


        case {...
              '221119-0500',...
              '221119-0600',...
              '221119-0100',...
            }
            a        = [1./0.099997714188	0];
            epochUtc = '2022/11/16 10:27:42.553';


        case {...
              '221121-0100',...
              '221122-0500',...
            }
            a        = [1./0.099997578663	0];
            epochUtc = '2022/11/16 10:27:42.553';

        case {...
              '221123-0500',...
            }
            a        = [1./0.099997712679	0];
            epochUtc = '2022/11/16 10:27:42.553';
            
        case {...
              '221123-0100',...
            }
            a        = [1./0.099997792926	0];
            epochUtc = '2022/11/16 10:27:42.553';

        case {...
              '221125-0500',...
            }
            a        = [1./0.099997441950	0];
            epochUtc = '2022/11/16 10:27:42.554';
        

        case {...
              '221125-0100',...
            }
            a        = [1./0.099997637003	0];
            epochUtc = '2022/11/16 10:27:42.553';
        

        case {...
              '221127-0100',...
              '221203-0100',...
            }
            a        = [1./0.099997576814	0];
            epochUtc = '2022/11/16 10:27:42.553';

        case {'221210-0100'}
            a = [1./0.099997565066 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'221215-0100'}
            a = [1./0.099997541829 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'221221-0100'}
            a = [1./0.099997472128 0];
            epochUtc = '2022/11/16 10:27:42.554';
        
        case {'221224-0100'}
            a = [1./0.099997526936 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230101-0100'}
            a = [1./0.099997525660 0];
            epochUtc = '2022/11/16 10:27:42.554';
        
        case {'230106-0100'}
            a = [10.000248379545 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230114-0100', '230115-0100'}
            a = [10.000247714298 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230118-0100', '230119-0100'}
            a = [10.000247326111 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230122-0100'}
            a = [10.000246279261 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230124-0100','230125-0100', '230131-0100'}
            a = [10.000249088235 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230201-0100','230203-0100'}
            a = [10.000247174973 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230204-0100','230211-0100'}
            a = [10.000245788720 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230218-0100'}
            a = [10.000249821444 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230224-0100'}
            a = [10.000246918265 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230227-0100'}
            a = [10.000246421395 0];
            epochUtc = '2022/11/16 10:27:42.554';

        case {'230303-0100', '230305-0100', '230310-0100', '230311-0100', '230316-0100'}
            a = [10.000248653125 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230318-0100'}
            a = [10.000250806240 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230321-0100'}
            a = [10.000249472575 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230330-0100', '230331-0100'}
            a = [10.000249620796 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230403-0100', '230404-0100'}
            a = [10.000250356729 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230408-0100'}
            a = [10.000250336553 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230409-0100', '230410-0100'}
            a = [10.000249407170 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230412-0100', '230413-0100', '230414-0100'}
            a = [10.000250743916 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230417-0100'}
            a = [10.000251028256 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230420-0100'}
            a = [10.000236206546 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230503-0100', '230505-0100', '230506-0100'}
            a = [10.000251095823 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230508-0100'}
            a = [10.000251095823 0];
            epochUtc = '2022/11/16 10:27:42.554';
        case {'230512-0100', '230516-0100'}
            a = [10.000249259219 0];
            epochUtc = '2022/11/16 10:27:42.554';
    end
    
%% Calc TI 2 Ephemerix time (UTC)
    tf = cspice_str2et(epochUtc);          % ephemeris time

    ti2Utc= ((ti-a(2))./a(1))+tf;          % calc ephemeris time

    ti2UtcStr = cspice_et2utc(ti2Utc','C',0); % utc

end